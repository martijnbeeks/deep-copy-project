DeepCopyStack.ApiEndpoint4F160690 = https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/
DeepCopyStack.ApiUrl = https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/
DeepCopyStack.CognitoIssuer = https://cognito-idp.eu-west-1.amazonaws.com/eu-west-1_ilJPIuXjB
DeepCopyStack.CognitoTokenEndpoint = https://deepcopy-613663743323-eu-west-1.auth.eu-west-1.amazoncognito.com/oauth2/token
DeepCopyStack.JobsTableName = DeepCopyStack-JobsTable1970BC16-1BVYVOHK8WXTU
DeepCopyStack.M2MClientId = 5e2k1st9li1eihp22fl33nd7if
DeepCopyStack.ResultsBucketName = deepcopystack-resultsbucketa95a2103-zhwjflrlpfih
DeepCopyStack.UserPoolId = eu-west-1_ilJPIuXjB

DeepCopyStack.ApiEndpoint4F160690 = https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/
DeepCopyStack.ApiUrl = https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/
DeepCopyStack.CognitoIssuer = https://cognito-idp.eu-west-1.amazonaws.com/eu-west-1_ilJPIuXjB
DeepCopyStack.CognitoTokenEndpoint = https://deepcopy-613663743323-eu-west-1.auth.eu-west-1.amazoncognito.com/oauth2/token
DeepCopyStack.JobsTableName = DeepCopyStack-JobsTable1970BC16-1BVYVOHK8WXTU
DeepCopyStack.M2MClientId = 5e2k1st9li1eihp22fl33nd7if
DeepCopyStack.PravahaClientId = 5mbatc7uv35hr23qip437s2ai5
DeepCopyStack.ResultsBucketName = deepcopystack-resultsbucketa95a2103-zhwjflrlpfih
DeepCopyStack.UserPoolId = eu-west-1_ilJPIuXjB



ACCESS_TOKEN=$(curl -s -u "$CLIENT_ID:$CLIENT_SECRET" \
  -d "grant_type=client_credentials&scope=https://deep-copy.api/read https://deep-copy.api/write" \
  "$TOKEN_ENDPOINT" | jq -r .access_token)

# POST /jobs (uses write) - Updated with customer_avatars
curl -sS -X POST "${API_URL}jobs" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"sales_page_url":"https://try.meritrelief.com/","project_name":"meritrelief","swipe_file_id":"A00002","advertorial_type":"Advertorial","customer_avatars":[{"persona_name":"Active Senior","description":"Retired professional who enjoys gardening and light exercise but struggles with chronic sciatic pain","age_range":"60-75","gender":"both","key_buying_motivation":"Seeking non-invasive pain relief to maintain active lifestyle"},{"persona_name":"Desk-Bound Professional","description":"Office worker sitting 8+ hours daily experiencing lower back pain","age_range":"30-45","gender":"both","key_buying_motivation":"Quick relief from work-related pain"}]}'



  curl -X POST "https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/avatars/extract" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"url": "https://naxir.co/products/footrevive?srsltid=AfmBOopi0uyM4_XKmqAgzsZUQf9Q4PcN1lGdnj-rPmrhF0l0GZO_v8rA"}' | jq '.'

# GET /jobs/{id} (uses read)
curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID"
curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID/result"

# POST /swipe-files/generate (uses write) - Submit swipe file generation job
curl -sS -X POST "${API_URL}swipe-files/generate" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "original_job_id": "03479dbf-bc4c-4472-80ff-b11b561b8777",
    "select_angle": "Embarrassment & Professional Confidence: '\''Restore the beard you earnedâ€”no flakes in meetings.'\''"
  }' | jq '.'

# GET /swipe-files/{id} (uses read) - Get swipe file generation job status
curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}swipe-files/YOUR_JOB_ID-swipe" | jq '.'

# GET /swipe-files/{id}/result (uses read) - Get swipe file generation results
curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}swipe-files/YOUR_JOB_ID-swipe/result" | jq '.'

AWS_PROFILE=personal-cdk-dev npx cdk deploy

2a122590-f4a3-4770-a275-81e7cc5d8062