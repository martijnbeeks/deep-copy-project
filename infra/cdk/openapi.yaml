openapi: 3.1.0
info:
  title: DeepCopy API
  version: 1.0.0
  description: |
    API for submitting AI processing jobs and retrieving their status and results.

    Authentication (OAuth2 client credentials via Amazon Cognito):

    ```bash
    # Set endpoints (from CDK outputs)
    API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
    TOKEN_ENDPOINT="https://deepcopy-613663743323-eu-west-1.auth.eu-west-1.amazoncognito.com/oauth2/token"

    # Your app client credentials (retrieve secret from Cognito console)
    CLIENT_ID="<your-client-id>"
    CLIENT_SECRET="<your-client-secret>"

    # Request access token with read+write scopes
    ACCESS_TOKEN=$(curl -s -u "$CLIENT_ID:$CLIENT_SECRET" \
      -d "grant_type=client_credentials&scope=https://deep-copy.api/read https://deep-copy.api/write" \
      "$TOKEN_ENDPOINT" | jq -r .access_token)

    echo "Token acquired: ${#ACCESS_TOKEN} chars"

    # Submit a job
    curl -sS -X POST \
      -H "Authorization: Bearer $ACCESS_TOKEN" \
      -H "content-type: application/json" \
      -d '{
        "sales_page_url": "https://try.meritrelief.com/",
        "project_name": "meritrelief",
        "advertorial_type": "Listicle",
        "persona": "Health-conscious professionals",
        "age_range": "30-45",
        "gender": "female"
      }' \
      "${API_URL}jobs"

    # Get job status (replace with real jobId)
    curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID"

    # Get job result JSON (404 until available)
    curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID/result"
    ```
servers:
  - url: https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/
security:
  - cognitoOAuth2: [ ]
paths:
  /jobs:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    post:
      summary: Submit a new job
      operationId: submitJob
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/write
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitJobRequest'
            examples:
              minimal:
                summary: Minimal payload
                value: {}
              full:
                summary: Full payload
                value:
                  sales_page_url: "https://try.meritrelief.com/"
                  project_name: "meritrelief"
                  advertorial_type: "Listicle"
                  customer_avatars:
                    - persona_name: "Active Senior"
                      characteristics:
                        - "Active lifestyle"
                        - "Gardening enthusiast"
                        - "Chronic pain"
                      description: "Retired professional who enjoys gardening and light exercise but struggles with chronic sciatic pain"
                      age_range: "60-75"
                      gender: "both"
                      key_buying_motivation: "Seeking non-invasive pain relief to maintain active lifestyle"
                      pain_point: "Chronic sciatic pain prevents them from enjoying favorite activities like gardening"
                      emotion: "Frustrated and limited, feeling their independence slipping away"
                      desire: "A natural solution that allows them to stay active without relying on prescription painkillers"
                      objections:
                        - "Will this actually work for chronic pain?"
                        - "Is it safe for someone my age?"
                        - "Can I afford another wellness product?"
                      failed_alternatives:
                        - "Prescription pain medication with unwanted side effects"
                        - "Physical therapy that didn't provide lasting relief"
                        - "Over-the-counter pain relievers that only work temporarily"
                    - persona_name: "Desk-Bound Professional"
                      characteristics:
                        - "Standing all day"
                        - "Work-related pain"
                        - "Evening fatigue"
                      description: "Office worker sitting 8+ hours daily experiencing lower back pain"
                      age_range: "30-45"
                      gender: "both"
                      key_buying_motivation: "Quick relief from work-related pain"
                      pain_point: "Stands all day at work (nurses, retail staff, warehouse workers). Feet ache, swell, and feel heavy every evening."
                      emotion: "Feels drained and defeated when coming home, wants relief to enjoy family time instead of collapsing on the couch."
                      desire: "Quick daily solution that soothes feet and restores energy without expensive spa visits."
                      objections:
                        - "Will this actually help after a long shift?"
                        - "Can I afford another wellness expense?"
                        - "Do I have time to use this daily?"
                      failed_alternatives:
                        - "Compression socks that don't provide enough relief"
                        - "Soaking feet in warm water (temporary relief only)"
                        - "Pain medication with unwanted side effects"
      responses:
        '202':
          description: Job accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmitJobResponse'
              examples:
                accepted:
                  value:
                    jobId: "c3f0e0c4-3a61-4c52-8b5a-2e0a8b8b4a5f"
                    taskArn: "arn:aws:ecs:eu-west-1:123456789012:task/cluster/1234567890abcdef"
                    status: "SUBMITTED"
        '400':
          description: Invalid request body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      x-codeSamples:
        - lang: bash
          label: curl (submit)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -X POST \
              -H "Authorization: Bearer $ACCESS_TOKEN" \
              -H "content-type: application/json" \
              -d '{
                "sales_page_url": "https://try.meritrelief.com/",
                "project_name": "meritrelief",
                "advertorial_type": "Listicle",
                "customer_avatars": [
                  {
                    "persona_name": "Active Senior",
                    "characteristics": ["Active lifestyle", "Gardening enthusiast", "Chronic pain"],
                    "description": "Retired professional who enjoys gardening and light exercise but struggles with chronic sciatic pain",
                    "age_range": "60-75",
                    "gender": "both",
                    "key_buying_motivation": "Seeking non-invasive pain relief to maintain active lifestyle"
                  }
                ]
              }' \
              "${API_URL}jobs"
  /jobs/{id}:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get job status
      operationId: getJob
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Job status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JobStatusResponse'
        '404':
          description: Job not found
          content:
            text/plain:
              schema:
                type: string
                example: "Not found"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (status)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID"
  /jobs/{id}/result:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get job result
      operationId: getJobResult
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Job result JSON or text
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JobResult'
            text/plain:
              schema:
                type: string
        '404':
          description: Result not available
          content:
            text/plain:
              schema:
                type: string
                example: "Result not available"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (result)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}jobs/YOUR_JOB_ID/result"
  /avatars/extract:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    post:
      summary: Submit an avatar extraction job
      operationId: submitAvatarExtraction
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/write
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [url]
              properties:
                url:
                  type: string
                  format: uri
                  description: URL of the product page to analyze
            examples:
              sciatica:
                summary: Sciatica product
                value:
                  url: "https://www.sciatiease.com/sciatiease.php"
      responses:
        '202':
          description: Avatar extraction job accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmitAvatarExtractionResponse'
              examples:
                accepted:
                  value:
                    jobId: "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
                    status: "SUBMITTED"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      x-codeSamples:
        - lang: bash
          label: curl (submit extraction)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -X POST \
              -H "Authorization: Bearer $ACCESS_TOKEN" \
              -H "content-type: application/json" \
              -d '{"url": "https://www.sciatiease.com/sciatiease.php"}' \
              "${API_URL}avatars/extract"
  /avatars/{id}:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get avatar extraction job status
      operationId: getAvatarExtractionStatus
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Avatar extraction job ID
      responses:
        '200':
          description: Job status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JobStatusResponse'
        '404':
          description: Job not found
          content:
            text/plain:
              schema:
                type: string
                example: "Not found"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (get status)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}avatars/YOUR_JOB_ID"
  /avatars/{id}/result:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get avatar extraction results
      operationId: getAvatarExtractionResult
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Avatar extraction job ID
      responses:
        '200':
          description: Avatar extraction results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AvatarExtractionResponse'
        '404':
          description: Result not available
          content:
            text/plain:
              schema:
                type: string
                example: "Result not available"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (get result)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}avatars/YOUR_JOB_ID/result"
  /swipe-files/generate:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    post:
      summary: Submit a swipe file generation job
      operationId: submitSwipeFileGeneration
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/write
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [original_job_id, select_angle]
              properties:
                original_job_id:
                  type: string
                  format: uuid
                  description: The job ID of the original comprehensive analysis job
                select_angle:
                  type: string
                  description: The marketing angle to focus on for the swipe files
                swipe_file_ids:
                  type: array
                  description: The IDs of the swipe files to generate
                  items:
                    type: string
                    format: uuid
            examples:
              example:
                summary: Generate swipe files for a marketing angle
                value:
                  original_job_id: "03479dbf-bc4c-4472-80ff-b11b561b8777"
                  select_angle: "Embarrassment & Professional Confidence: 'Restore the beard you earned—no flakes in meetings.'"
      responses:
        '202':
          description: Swipe file generation job accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmitSwipeFileResponse'
              examples:
                accepted:
                  value:
                    jobId: "03479dbf-bc4c-4472-80ff-b11b561b8777-swipe"
                    status: "SUBMITTED"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      x-codeSamples:
        - lang: bash
          label: curl (submit swipe file generation)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -X POST \
              -H "Authorization: Bearer $ACCESS_TOKEN" \
              -H "content-type: application/json" \
              -d '{
                "original_job_id": "03479dbf-bc4c-4472-80ff-b11b561b8777",
                "select_angle": "Embarrassment & Professional Confidence: '\''Restore the beard you earned—no flakes in meetings.'\''"
              }' \
              "${API_URL}swipe-files/generate"
  /swipe-files/{id}:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get swipe file generation job status
      operationId: getSwipeFileGenerationStatus
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Swipe file generation job ID
      responses:
        '200':
          description: Job status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JobStatusResponse'
        '404':
          description: Job not found
          content:
            text/plain:
              schema:
                type: string
                example: "Not found"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (get status)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}swipe-files/YOUR_JOB_ID"
  /swipe-files/{id}/result:
    options:
      summary: CORS preflight
      responses:
        '204':
          description: No Content
          headers:
            Access-Control-Allow-Origin: { $ref: '#/components/headers/AccessControlAllowOrigin' }
            Access-Control-Allow-Headers: { $ref: '#/components/headers/AccessControlAllowHeaders' }
            Access-Control-Allow-Methods: { $ref: '#/components/headers/AccessControlAllowMethods' }
    get:
      summary: Get swipe file generation results
      operationId: getSwipeFileGenerationResult
      security:
        - cognitoOAuth2:
            - https://deep-copy.api/read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Swipe file generation job ID
      responses:
        '200':
          description: Swipe file generation results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SwipeFileGenerationResponse'
        '404':
          description: Result not available
          content:
            text/plain:
              schema:
                type: string
                example: "Result not available"
        '500':
          description: Server error
          content:
            text/plain:
              schema:
                type: string
      x-codeSamples:
        - lang: bash
          label: curl (get result)
          source: |-
            API_URL="https://o5egokjpsl.execute-api.eu-west-1.amazonaws.com/prod/"
            curl -sS -H "Authorization: Bearer $ACCESS_TOKEN" "${API_URL}swipe-files/YOUR_JOB_ID/result"
components:
  securitySchemes:
    cognitoOAuth2:
      type: oauth2
      description: |
        OAuth2 client credentials against Amazon Cognito User Pool domain.
        Use the token endpoint output by the stack to obtain an access token.
      flows:
        clientCredentials:
          tokenUrl: https://deepcopy-613663743323-eu-west-1.auth.eu-west-1.amazoncognito.com/oauth2/token
          scopes:
            https://deep-copy.api/read: Read jobs and results
            https://deep-copy.api/write: Submit jobs
  schemas:
    SubmitJobRequest:
      type: object
      additionalProperties: true
      properties:
        sales_page_url:
          type: string
          format: uri
          description: URL to the sales page to analyze
        project_name:
          type: string
        advertorial_type:
          type: string
        customer_avatars:
          type: array
          description: List of customer avatars/personas to target
          items:
            $ref: '#/components/schemas/CustomerAvatar'
        persona:
          type: string
          deprecated: true
          description: (Deprecated) Use customer_avatars instead
        age_range:
          type: string
          deprecated: true
          description: (Deprecated) Use customer_avatars instead
        gender:
          type: string
          deprecated: true
          description: (Deprecated) Use customer_avatars instead
      example:
        sales_page_url: "https://try.meritrelief.com/"
        project_name: "meritrelief"
        advertorial_type: "Listicle"
        customer_avatars:
          - persona_name: "Active Senior"
            characteristics:
              - "Active lifestyle"
              - "Gardening enthusiast"
              - "Chronic pain"
            description: "Retired professional who enjoys gardening and light exercise but struggles with chronic sciatic pain"
            age_range: "60-75"
            gender: "both"
            key_buying_motivation: "Seeking non-invasive pain relief to maintain active lifestyle"
            pain_point: "Chronic sciatic pain prevents them from enjoying favorite activities like gardening"
            emotion: "Frustrated and limited, feeling their independence slipping away"
            desire: "A natural solution that allows them to stay active without relying on prescription painkillers"
            objections:
              - "Will this actually work for chronic pain?"
              - "Is it safe for someone my age?"
              - "Can I afford another wellness product?"
            failed_alternatives:
              - "Prescription pain medication with unwanted side effects"
              - "Physical therapy that didn't provide lasting relief"
              - "Over-the-counter pain relievers that only work temporarily"
          - persona_name: "Desk-Bound Professional"
            characteristics:
              - "Standing all day"
              - "Work-related pain"
              - "Evening fatigue"
            description: "Office worker sitting 8+ hours daily experiencing lower back pain"
            age_range: "30-45"
            gender: "both"
            key_buying_motivation: "Quick relief from work-related pain"
            pain_point: "Stands all day at work (nurses, retail staff, warehouse workers). Feet ache, swell, and feel heavy every evening."
            emotion: "Feels drained and defeated when coming home, wants relief to enjoy family time instead of collapsing on the couch."
            desire: "Quick daily solution that soothes feet and restores energy without expensive spa visits."
            objections:
              - "Will this actually help after a long shift?"
              - "Can I afford another wellness expense?"
              - "Do I have time to use this daily?"
            failed_alternatives:
              - "Compression socks that don't provide enough relief"
              - "Soaking feet in warm water (temporary relief only)"
              - "Pain medication with unwanted side effects"
    SubmitJobResponse:
      type: object
      required: [jobId, status]
      properties:
        jobId:
          type: string
          format: uuid
        taskArn:
          type: string
          nullable: true
        status:
          type: string
          enum: [SUBMITTED]
    JobStatusResponse:
      type: object
      required: [jobId, status]
      properties:
        jobId:
          type: string
        status:
          type: string
          description: Current job status, e.g. SUBMITTED, RUNNING, SUCCEEDED, FAILED
    JobResult:
      type: object
      description: Structured JSON produced by the pipeline including rewritten advertorial content.
      additionalProperties: false
      properties:
        project_name:
          type: string
        timestamp_iso:
          type: string
          format: date-time
        job_id:
          type: string
        results:
          type: object
          additionalProperties: false
          properties:
            research_page_analysis:
              type: string
            doc1_analysis:
              type: string
            doc2_analysis:
              type: string
            deep_research_prompt:
              type: string
            deep_research_output:
              type: string
            avatar_sheet:
              $ref: '#/components/schemas/Avatar'
            offer_brief:
              $ref: '#/components/schemas/OfferBrief'
            marketing_philosophy_analysis:
              type: string
            summary:
              type: string
            swipe_results:
              type: array
              items:
                $ref: '#/components/schemas/SwipeResult'
            marketing_angles:
              type: array
              items:
                $ref: '#/components/schemas/Angle'
      required: [project_name, timestamp_iso, results, job_id]
    SwipeResult:
      type: object
      description: Result item for a specific marketing angle containing structured advertorial content.
      required: [angle, content]
      properties:
        angle:
          type: string
          description: Marketing angle used to generate the content.
        content:
          description: Structured content; either a Listicle or an Avertorial.
          oneOf:
            - $ref: '#/components/schemas/Listicle'
            - $ref: '#/components/schemas/Avertorial'
    ListicleItem:
      type: object
      required: [number, title, description]
      properties:
        number:
          type: integer
          description: Number of the listicle item.
        title:
          type: string
          description: Title of the listicle item.
        description:
          type: string
          description: Description of the listicle item.
    Listicle:
      type: object
      description: Structured Listicle content returned by the pipeline.
      required: [title, author, summary, listicles, cta, conclusion]
      properties:
        title:
          type: string
          description: Title of the listicle.
        author:
          type: string
          description: Author and date of the listicle.
        summary:
          type: string
          description: Intro/summary paragraph of the listicle.
        listicles:
          type: array
          description: List of listicle items.
          items:
            $ref: '#/components/schemas/ListicleItem'
        cta:
          type: string
          description: Call-to-action of the listicle.
        conclusion:
          type: string
          description: Conclusion of the listicle.
    Avertorial:
      type: object
      description: Structured Advertorial content returned by the pipeline.
      required: [title, subtitle, body, cta, captions]
      properties:
        title:
          type: string
          description: Title of the advertorial.
        subtitle:
          type: string
          description: Subtitle of the advertorial.
        body:
          type: string
          description: Body/content of the advertorial.
        cta:
          type: string
          description: Call-to-action of the advertorial.
        captions:
          type: string
          description: Captions of the advertorial.
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
    SubmitAvatarExtractionResponse:
      type: object
      required: [jobId, status]
      properties:
        jobId:
          type: string
          format: uuid
          description: Avatar extraction job ID
        status:
          type: string
          enum: [SUBMITTED]
          description: Job status
    AvatarExtractionResponse:
      type: object
      required: [success, url, job_id, timestamp_iso, avatars, company_type, product_description]
      properties:
        success:
          type: boolean
          description: Whether the extraction was successful
        url:
          type: string
          format: uri
          description: The URL that was analyzed
        job_id:
          type: string
          description: The job ID for this extraction
        timestamp_iso:
          type: string
          format: date-time
          description: When the extraction was completed
        avatars:
          type: array
          description: List of extracted customer avatars
          items:
            $ref: '#/components/schemas/CustomerAvatar'
        company_type:
          type: string
          description: The type of company the product is for
        product_description:
          type: string
          description: A description of the product
    SubmitSwipeFileResponse:
      type: object
      required: [jobId, status]
      properties:
        jobId:
          type: string
          format: uuid
          description: Swipe file generation job ID
        status:
          type: string
          enum: [SUBMITTED]
          description: Job status
    SwipeFileGenerationResponse:
      type: object
      description: Swipe file generation results containing rewritten advertorial content
      additionalProperties: true
      properties:
        L00001:
          type: object
          description: Generated swipe file for template L00001
          additionalProperties: true
        A00003:
          type: object
          description: Generated swipe file for template A00003
          additionalProperties: true
      example:
        L00001:
          full_advertorial:
            title: "Example Title"
            subtitle: "Example Subtitle"
        A00003:
          full_advertorial:
            title: "Example Title"
            subtitle: "Example Subtitle"
    Demographics:
      type: object
      properties:
        age_range:
          type: integer
          nullable: true
          description: "Inclusive min/max age in years, e.g. (28, 45)"
        gender:
          type: array
          nullable: true
          description: "Gender distribution labels, e.g. ['male', 'female', 'non-binary']"
          items:
            type: string
        locations:
          type: array
          nullable: true
          description: "Primary regions/countries where the segment is concentrated"
          items:
            type: string
        monthly_revenue:
          type: integer
          nullable: true
          description: "Typical monthly revenue range (min, max) in your chosen currency"
        professional_backgrounds:
          type: array
          description: "Typical professional backgrounds (e.g., 'founder', 'marketing lead')"
          items:
            type: string
        typical_identities:
          type: array
          description: "Typical identities/lifestyles/roles (e.g., 'bootstrapped founder')"
          items:
            type: string
    PainPointGroup:
      type: object
      required: [title, bullets]
      properties:
        title:
          type: string
          description: "Name of the pain point theme, e.g., 'Lead Generation'"
        bullets:
          type: array
          minItems: 1
          description: "Concrete challenges/concerns under this theme"
          items:
            type: string
    Goals:
      type: object
      properties:
        short_term:
          type: array
          description: "Short-term goals (weeks/months)"
          items:
            type: string
        long_term:
          type: array
          description: "Long-term aspirations (quarters/years)"
          items:
            type: string
    Quotes:
      type: object
      properties:
        general_client:
          type: array
          description: "General direct client quotes, e.g., \"I just need consistent leads.\""
          items:
            type: string
        pain_frustrations:
          type: array
          description: "Quotes that express pains/frustrations"
          items:
            type: string
        mindset:
          type: array
          description: "Quotes that capture mindset, e.g., principles or mottos"
          items:
            type: string
        emotional_state_drivers:
          type: array
          description: "Quotes about emotional state/personal drivers"
          items:
            type: string
    EmotionalJourney:
      type: object
      required: [awareness, frustration, seeking_solutions, relief_commitment]
      properties:
        awareness:
          type: string
          description: "Initial awareness stage (problem/status quo)"
        frustration:
          type: string
          description: "Frustration stage (failed attempts/costs of inaction)"
        seeking_solutions:
          type: string
          description: "Desperation & seeking solutions stage (research/criteria)"
        relief_commitment:
          type: string
          description: "Relief & commitment stage (decision/outcome)"
    Angle:
      type: object
      required: [angle, title, target_age_range, target_audience, pain_points, desires, common_objections, failed_alternatives, copy_approach]
      properties:
        angle:
          type: string
          description: "The marketing angle for the product"
        title:
          type: string
          description: "The title of the marketing angle"
        target_age_range:
          type: string
          description: "The target age range for the marketing angle. Note it like: 45-55, 60-70, etc."
        target_audience:
          type: string
          description: "The target audience for the marketing angle. Note it like: Competitive athletes seeking reliability, Skilled professionals seeking productivity, etc."
        pain_points:
          type: array
          description: "The pain points for the marketing angle"
          items:
            type: string
        desires:
          type: array
          description: "The desires for the marketing angle"
          items:
            type: string
        common_objections:
          type: array
          description: "The common objections for the marketing angle"
          items:
            type: string
        failed_alternatives:
          type: array
          description: "The failed alternatives for the marketing angle"
          items:
            type: string
        copy_approach:
          type: array
          description: "The copy approaches for the marketing angle"
          items:
            type: string
    Avatar:
      type: object
      description: "Marketing Avatar sheet for product–market fit & messaging research"
      required: [demographics, pain_points, goals, quotes, emotional_journey]
      properties:
        demographics:
          $ref: '#/components/schemas/Demographics'
        pain_points:
          type: array
          minItems: 1
          description: "List of pain point themes, each with concrete challenges"
          items:
            $ref: '#/components/schemas/PainPointGroup'
        goals:
          $ref: '#/components/schemas/Goals'
        emotional_drivers:
          type: array
          description: "Emotional drivers & psychological insights"
          items:
            type: string
        quotes:
          $ref: '#/components/schemas/Quotes'
        emotional_journey:
          $ref: '#/components/schemas/EmotionalJourney'
        marketing_angles:
          type: array
          description: "Main marketing angles to test or use"
          items:
            $ref: '#/components/schemas/Angle'
    CustomerAvatar:
      type: object
      required: [persona_name, characteristics, description, age_range, gender, key_buying_motivation, pain_point, emotion, desire, objections, failed_alternatives]
      properties:
        persona_name:
          type: string
          description: A short, descriptive name that captures the essence of the customer
        characteristics:
          type: array
          description: Characteristics of the customer, e.g. Stands all day, Active lifestyle, etc. Provide at least 3 characteristics and max three words each.
          items:
            type: string
        description:
          type: string
          description: 1 sentence summarizing their lifestyle, motivations, and key challenges
        age_range:
          type: string
          description: Approximate age bracket (e.g., 25-34)
        gender:
          type: string
          description: male, female, or both
        key_buying_motivation:
          type: string
          description: What drives them to purchase this product
        pain_point:
          type: string
          description: Specific problem or challenge the customer faces
        emotion:
          type: string
          description: Emotion they feel related to the pain point
        desire:
          type: string
          description: What they desire as a solution to their pain point
        objections:
          type: array
          description: List of objections or concerns they might have
          items:
            type: string
        failed_alternatives:
          type: array
          description: List of alternatives they've tried that didn't work
          items:
            type: string
        is_broad_avatar:
          type: boolean
          description: Whether this avatar represents the overall customer base
    ConsciousnessLevel:
      type: string
      enum: [low, high]
      description: How self-aware and change-ready the prospect is
    AwarenessLevel:
      type: string
      enum: [unaware, problem_aware, solution_aware, product_aware, most_aware]
      description: Prospect's awareness per Schwartz's stages
    SophisticationLevel:
      type: string
      enum: [level_1, level_2, level_3, level_4, level_5]
      description: Market sophistication level (make claims → mechanisms → advanced strategies)
    StageOfSophistication:
      type: object
      required: [level]
      properties:
        level:
          $ref: '#/components/schemas/SophisticationLevel'
        rationale:
          type: string
          nullable: true
          description: Why this level fits (signals from ads, competitors, buyer skepticism)
    HeadlineIdea:
      type: object
      required: [headline]
      properties:
        headline:
          type: string
          description: Punchy primary promise or hook
        subheadline:
          type: string
          nullable: true
          description: Clarifies/grounds the headline with specifics, mechanism, or outcome
    BeliefChain:
      type: object
      required: [outcome, steps]
      properties:
        outcome:
          type: string
          description: What the buyer must feel confident about (e.g., 'This can work for me')
        steps:
          type: array
          description: Ordered micro-beliefs (e.g., problem is real → solution type works → this product's mechanism works → I can use it)
          items:
            type: string
    SwipeExample:
      type: object
      required: [title]
      properties:
        title:
          type: string
          description: Short label for the swipe (publisher, creator, or concept)
        url:
          type: string
          format: uri
          nullable: true
          description: Link to the asset if available
        notes:
          type: string
          nullable: true
          description: "What to model: headline structure, proof style, funnel flow, etc."
    ProductInfo:
      type: object
      properties:
        name:
          type: string
          nullable: true
          description: Working name of the product/offer
        description:
          type: string
          nullable: true
          description: What it is, who it's for, core outcomes/benefits
        details:
          type: string
          nullable: true
          description: Format, modules, deliverables, bonuses, guarantees, price points, terms
    OfferBrief:
      type: object
      description: Structured brief to guide AI when generating copy, concepts, and funnel assets
      properties:
        potential_product_names:
          type: array
          description: Brainstormed product/offer name options
          items:
            type: string
        level_of_consciousness:
          $ref: '#/components/schemas/ConsciousnessLevel'
          description: Prospect's general self-awareness/readiness to change
        level_of_awareness:
          $ref: '#/components/schemas/AwarenessLevel'
          description: Prospect's current awareness of problem/solution/product
        stage_of_sophistication:
          $ref: '#/components/schemas/StageOfSophistication'
          description: Market sophistication selection with reasoning
        big_idea:
          type: string
          nullable: true
          description: Single, transformative central idea that unifies the campaign
        metaphors:
          type: array
          description: Images/analogies to make the big idea and mechanism vivid
          items:
            type: string
        potential_ump:
          type: array
          description: "Unique Mechanism of the Problem: counterintuitive reason the problem persists"
          items:
            type: string
        potential_ums:
          type: array
          description: "Unique Mechanism of the Solution: how THIS solution uniquely works"
          items:
            type: string
        guru:
          type: string
          nullable: true
          description: Authority or spokesperson (real or archetype) associated with the offer
        discovery_story:
          type: string
          nullable: true
          description: "Origin narrative: aha moment, failed attempts, breakthrough mechanism"
        product:
          $ref: '#/components/schemas/ProductInfo'
          description: Core product details to anchor claims and copy
        headline_ideas:
          type: array
          description: Potential headline/subheadline pairs for ads, LPs, emails
          items:
            $ref: '#/components/schemas/HeadlineIdea'
        objections:
          type: array
          description: All likely objections (price, time, credibility, fit, complexity, risk)
          items:
            type: string
        belief_chains:
          type: array
          description: Required belief paths the buyer must traverse to purchase
          items:
            $ref: '#/components/schemas/BeliefChain'
        funnel_architecture:
          type: array
          description: High-level funnel steps in order (e.g., 'Ad → Lead Magnet → Nurture → VSL → Checkout → Upsell')
          items:
            type: string
        potential_domains:
          type: array
          description: Available or desired domains/URLs for the offer
          items:
            type: string
        examples_swipes:
          type: array
          description: Reference campaigns, pages, or ads to emulate
          items:
            $ref: '#/components/schemas/SwipeExample'
        other_notes:
          type: string
          nullable: true
          description: "Anything else helpful: compliance constraints, must-include proof, JTBD, ICP nuances"
  headers:
    AccessControlAllowOrigin:
      schema:
        type: string
        example: "*"
      description: CORS allow origin
    AccessControlAllowHeaders:
      schema:
        type: string
        example: "*"
      description: CORS allow headers
    AccessControlAllowMethods:
      schema:
        type: string
        example: "*"
      description: CORS allow methods
